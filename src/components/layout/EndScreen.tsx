// src/components/layout/EndScreen.tsx
import React, { useEffect, useState } from "react";

// On type les lignes comme pouvant être une string ou un élément React (JSX)
const TERMINAL_LINES: (string | React.ReactNode)[] = [
  "/ C:\\Windows\\system32\\end.exe - dedale / ?",
  "/ COPY [/D] [/V] [/N] [/-Y] [/Z] [/L] [/A | /B] source [/A | /B]",
  "/T Thanks for playing dedale demo",
  "/P People working in this project :",
  "/",
  // Utilisation de JSX pour le gras
  <><span className="font-bold">/B Bastien BRAHIC</span></>,
  ">>>web_design/motion_design/",
  <><span className="font-bold">/E Ethel SERER</span></>,
  ">>>motion_design/video_editing/narration",
  <><span className="font-bold">/M Mathis EYSSAUTIER</span></>,
  ">>>sound_design/video_editing/narration",
  <><span className="font-bold">/N Nicolas ASRI</span></>,
  ">>>web_design/video_editing/narration",
  "/",
  "/",
  "/",
  "/ System halting...",
];

export const EndScreen: React.FC = () => {
  // On stocke des nœuds React, pas juste des strings
  const [lines, setLines] = useState<React.ReactNode[]>([]);

  // Effet d'écriture du terminal
  useEffect(() => {
    let currentIndex = 0;
    const interval = setInterval(() => {
      if (currentIndex >= TERMINAL_LINES.length) {
        clearInterval(interval);
        return;
      }
      // On ajoute la ligne courante (string ou JSX)
      setLines((prev) => [...prev, TERMINAL_LINES[currentIndex]]);
      currentIndex++;
    }, 400);

    return () => clearInterval(interval);
  }, []);

  const handleRestart = () => {
    window.location.reload();
  };

  return (
    <div className="fixed inset-0 z-[999999] bg-[#393C41] font-ubuntu flex items-center justify-center">
      
      {/* CONTENEUR CENTRAL */}
      <div 
        className="flex flex-col bg-[#393C41] border-2 border-[#E8E8E8]"
        style={{
            width: "calc(100vw - 300px)",
            height: "calc(100vh - 160px)"
        }}
      >

        {/* --- 1. HEADER (Full Width) --- */}
        <div className="h-[45px] relative shrink-0 border-b-2 border-[#E8E8E8]">
          <svg
            className="w-full h-full object-cover"
            preserveAspectRatio="none"
            viewBox="0 0 1642 45"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <rect width="100%" height="100%" fill="url(#pattern0_inverted)" />
            <rect width="75" height="33" x="100%" y="6" transform="translate(-82, 0)" fill="#E8E8E8" />
            <defs>
              <pattern id="pattern0_inverted" patternUnits="userSpaceOnUse" patternTransform="matrix(5.14536 0 0 5.52733 0 0)" preserveAspectRatio="none" viewBox="0 0 8.29896 8.91504" width="1" height="1">
                <g id="pattern0_117_149_inner">
                  <path d="M0 2.472H2.268V0H3.228V2.472H5.496V3.42H3.228V5.904H2.268V3.42H0V2.472Z" fill="#E8E8E8" />
                </g>
              </pattern>
            </defs>
          </svg>

          <button
            onClick={handleRestart}
            className="absolute top-[6px] right-[6px] w-[85px] h-[33px] flex items-center justify-center text-[#393C41] text-xs font-bold uppercase tracking-wider hover:opacity-80 cursor-pointer"
          >
            Restart
          </button>
        </div>

        {/* --- 2. MIDDLE SECTION (Flex Row) --- */}
        <div className="flex-1 flex overflow-hidden">
          
          {/* COLONNE GAUCHE : VIDEO */}
          <div className="flex-1 bg-black relative border-r-2 border-[#E8E8E8]">
            <video
              src="/loading.mp4" 
              autoPlay
              loop
              muted
              className="w-full h-full object-cover"
            />
          </div>

          {/* COLONNE DROITE : INFO */}
          <div className="w-[45%] min-w-[350px] flex flex-col">
            
            {/* Titre DAEDAL */}
            <div className="h-[80px] shrink-0 border-b-2 border-[#E8E8E8] flex items-center justify-center bg-[#393C41]">
              <h1 className="text-4xl font-bold tracking-widest text-[#E8E8E8]">DAEDAL</h1>
            </div>

            {/* Terminal */}
            <div className="flex-1 bg-[#393C41] text-[#E8E8E8] font-mono text-sm p-4 overflow-y-auto custom-scrollbar">
              {lines.map((line, i) => (
                <div key={i} className="mb-1 whitespace-pre-wrap leading-tight opacity-90">
                  {/* React rendra automatiquement le JSX (le gras) ou la string */}
                  {line}
                </div>
              ))}
              <div className="animate-pulse inline-block w-2 h-4 bg-[#E8E8E8] ml-1 align-middle"/>
            </div>
          </div>
        </div>

        {/* --- 3. FOOTER (Full Width) --- */}
        <div className="h-[100px] shrink-0 border-t-2 border-[#E8E8E8] bg-[#393C41] flex items-center justify-between px-8">
            {/* SVG Logos (inchangés, je les ai raccourcis pour la lisibilité ici mais garde les tiens complets) */}
            <svg width="116" height="70" viewBox="0 0 116 70" fill="none" className="h-12 w-auto">
              <path d="M57.505 16.9083C55.8161 16.9083 54.4449 15.5371 54.4449 13.8482C54.4449 12.1626 55.8161 10.7914 57.505 10.7914C59.1939 10.7914 60.5619 12.1626 60.5619 13.8482C60.5619 15.5371 59.1939 16.9083 57.505 16.9083ZM57.4823 2.26204e-06C49.8321 2.26204e-06 43.6309 6.20123 43.6309 13.8482C43.6309 21.4985 49.8321 27.6997 57.4823 27.6997C65.1293 27.6997 71.3305 21.4985 71.3305 13.8482C71.3305 6.20123 65.1293 2.26204e-06 57.4823 2.26204e-06Z" fill="#E8E8E8"/>
              <path d="M67.2897 55.1832L67.8408 54.9141C68.3918 54.6289 71.1245 53.115 70.5832 51.1992C70.1683 49.7308 68.3108 49.1375 68.3108 49.1375C68.3108 49.1375 56.7706 45.6787 49.6066 43.3448C42.1963 40.9362 41.9726 35.6394 41.9078 34.6767C41.4961 28.8353 45.9339 26.404 46.5368 26.0993L46.8837 25.9308L47.0133 26.1415L46.767 26.2711C46.3909 26.4624 44.1899 27.6877 44.4914 29.2923C44.7863 30.8451 46.7183 31.3702 46.7183 31.3702C46.7183 31.3702 58.2585 34.8258 65.4193 37.1597C72.8296 39.5715 73.0533 44.8651 73.1214 45.8278C73.572 52.2722 68.7873 54.765 68.0028 55.1281L67.442 55.4004L67.2897 55.1832Z" fill="#E8E8E8"/>
              <path d="M8.79777 61.0272C8.13648 60.1098 6.99867 59.5587 5.89003 59.5587C4.94348 59.5587 4.02934 59.9023 3.32915 60.5182C2.56412 61.1925 2.05195 62.2849 2.05195 63.306C2.05195 64.2331 2.47012 65.2218 3.1152 65.8799C3.86402 66.6773 4.9143 67.1247 5.97755 67.1247C7.28393 67.1247 8.61624 66.3175 9.21594 65.1343H4.5869V63.199H11.8092V63.4389C11.8092 66.6773 9.08303 69.1215 5.91921 69.1215C2.72621 69.1215 0 66.6319 0 63.3806C0 60.1098 2.71 57.5651 5.89003 57.5651C8.13648 57.5651 10.4153 58.8974 11.2549 61.0272H8.79777Z" fill="#E8E8E8"/>
              <path d="M23.3834 57.5641C20.1936 57.5641 17.6133 60.1445 17.6133 63.3796C17.6133 66.5694 20.2325 69.1205 23.3996 69.1205C26.5602 69.1205 29.1664 66.5564 29.1664 63.3634C29.1664 60.1282 26.5731 57.5641 23.3834 57.5641ZM27.1145 63.3634C27.1145 65.4315 25.4224 67.1269 23.3834 67.1269C21.3574 67.1269 19.6685 65.4186 19.6685 63.3796C19.6685 61.2823 21.3152 59.5577 23.3834 59.6031L23.3672 59.5577C25.4353 59.5577 27.1145 61.2531 27.1145 63.3634Z" fill="#E8E8E8"/>
              <path d="M38.6743 62.0294V59.7668H39.0471C39.4847 59.7668 40.0066 59.6922 40.3956 59.8738C40.8008 60.0391 41.0861 60.3989 41.0861 60.8463C41.0861 61.2644 40.8462 61.6826 40.4572 61.8641C40.0682 62.0457 39.4977 62.0294 39.0666 62.0294H38.6743ZM36.6191 68.8498H39.394C40.4572 68.8174 41.5821 68.7591 42.4638 68.114C43.3228 67.4689 43.8155 66.5548 43.8155 65.4785C43.8155 64.2175 43.138 63.1835 41.9257 62.7945C42.7361 62.4055 43.138 61.5529 43.138 60.6809C43.138 59.6469 42.4962 58.6582 41.5821 58.1946C40.6517 57.7278 39.6339 57.7732 38.6289 57.7732H36.6191V68.8498ZM38.6743 66.8562V64.023H39.5723C40.0682 64.023 40.561 64.0068 41.0277 64.2467C41.5075 64.519 41.7604 64.8497 41.7604 65.3878C41.7604 65.8546 41.595 66.2111 41.2222 66.4672C40.6841 66.827 40.1266 66.8562 39.5269 66.8562H38.6743Z" fill="#E8E8E8"/>
              <path d="M51.9873 57.7733H57.9389V59.7701H54.0425V62.3148H57.7736V64.3084H54.0425V66.8563H57.9389V68.8499H51.9873V57.7733Z" fill="#E8E8E8"/>
              <path d="M66.6621 57.7733H68.7173V66.8563H72.1016V68.8499H66.6621V57.7733Z" fill="#E8E8E8"/>
              <path d="M79.7295 57.7738H81.7783V68.8505H79.7295V57.7738Z" fill="#E8E8E8"/>
              <path d="M91.0059 57.7733H93.3171L97.93 65.8676V57.7733H99.9819V68.8499H97.7063L93.0578 60.7847V68.8499H91.0059V57.7733Z" fill="#E8E8E8"/>
              <path d="M110.312 65.7324C110.312 66.6174 111.035 67.1263 111.855 67.1263C112.636 67.1263 113.298 66.5428 113.298 65.7324C113.298 64.5168 112.28 64.157 111.365 63.8587C110.626 63.6189 110.001 63.4082 109.443 62.8409C108.905 62.2833 108.574 61.4762 108.574 60.7111C108.574 58.8991 110.069 57.5635 111.842 57.5635C113.547 57.5635 115.097 58.9704 115.077 60.7111H112.96C112.931 60.0207 112.364 59.5571 111.722 59.5571C111.048 59.5571 110.61 60.066 110.626 60.7273C110.61 61.5345 111.365 61.8489 112.02 62.0759C112.802 62.3449 113.547 62.5686 114.176 63.0937C114.97 63.7258 115.346 64.533 115.346 65.6125C115.346 67.5899 113.716 69.1199 111.748 69.1199C109.865 69.1199 108.166 67.6677 108.166 65.7324H110.312Z" fill="#E8E8E8"/>
            </svg>

            <svg width="190" height="80" viewBox="0 0 190 80" fill="none" className="h-12 w-auto">
              <g clipPath="url(#clip0_119_220)">
                <path d="M32.8822 21.166C33.104 19.9652 33.1848 18.7483 33.1848 17.7371C33.181 14.281 32.2288 11.7272 30.5478 10.0194C28.8642 8.31245 26.3685 7.35267 22.9815 7.34762C15.7595 7.39968 10.7498 12.4826 10.6829 21.0626C10.6864 25.681 12.0024 29.0813 14.2223 31.3514C16.4435 33.6183 19.6358 34.8346 23.6586 34.839L23.6658 34.8375C26.2982 34.839 28.4528 34.2866 30.1442 33.1842C31.6331 32.2014 32.6658 30.8431 33.1126 28.8566L31.2479 28.2606C30.9261 29.8066 30.3004 31.0971 29.2595 32.0398C27.9685 33.205 26.1827 33.7057 23.9956 33.7086H23.9451C21.0171 33.7101 18.4454 32.5481 16.67 30.4979C14.9035 28.466 13.3549 25.5854 13.3549 22.1713V21.166H32.8822ZM13.2701 20.0406L13.2953 19.7333L13.3584 18.9546C13.5894 16.0731 14.883 13.6168 16.3835 11.6446C17.8866 9.65527 20.2508 8.35031 23.0156 8.35284L23.0313 8.35441L23.0657 8.35284C25.4053 8.35189 27.38 9.18421 28.7093 10.6652C30.0388 12.1377 30.8731 14.1756 30.8781 16.4722V16.5047C30.8781 17.3613 30.8731 18.8527 30.6273 19.8248L30.5721 20.0406H13.2704H13.2701ZM0 34.5122H2.06944V0H0V34.5122ZM62.8949 32.9321C62.8599 32.9321 62.8245 32.9311 62.7886 32.9311H62.7677C59.7376 32.9311 57.2147 31.5807 55.5104 29.4204C53.7956 27.2598 52.8698 24.3167 52.8698 21.0774C52.8717 17.8929 53.5962 14.9798 55.1257 12.8142C56.6393 10.6494 59.0113 9.27918 62.0386 9.27918H62.0973C65.7257 9.27918 68.3823 11.6158 69.4168 14.9211C70.3791 14.6195 71.2361 14.3109 72.3018 13.9686C71.3528 9.81775 67.8421 7.32364 62.1844 7.28609C53.7665 7.33437 49.4251 12.8467 49.361 21.0774C49.4112 29.2722 54.2411 34.8867 62.6071 34.9267C68.8126 34.8665 71.6958 32.5014 72.9389 27.9259C72.0283 27.6302 71.3187 27.4188 70.3479 27.1207C69.4291 30.484 67.0126 32.9321 62.8949 32.9321ZM94.3229 7.24918C88.6071 7.28262 85.8751 9.40096 84.456 15.1511L83.8208 15.125L82.6184 7.82025H79.8586V34.5428H84.8724V26.566C84.8775 18.4574 87.7357 11.6928 93.0868 11.637H93.106C94.7523 11.637 96.1507 12.1696 97.1143 13.2713C98.0797 14.3756 98.5927 16.0056 98.5927 18.1447V34.5447L103.597 34.5428V17.7317C103.562 11.2306 100.507 7.27663 94.3226 7.24918H94.3229ZM179.21 7.28515C175.105 7.28515 172.13 10.6116 170.332 15.0675C168.687 9.63539 164.523 7.28515 160.983 7.28515C156.419 7.28515 153.143 10.215 151.334 14.9723L150.653 14.9678L149.221 7.78429H143.456V34.5481H152.938V27.8871C152.938 25.1219 153.039 16.0952 157.778 16.0952C158.436 16.0952 160.251 16.0952 160.251 19.8318V34.5481H171.165V27.8871C171.165 22.2079 172.494 16.0952 176.003 16.0952C176.659 16.0952 178.475 16.0952 178.475 19.8318V34.5481H189.3V19.8318C189.3 9.46154 183.812 7.28515 179.21 7.28515ZM135.332 27.5914V18.9846C135.332 11.1259 131.362 7.3066 123.194 7.3066C115.478 7.3066 111.056 10.2355 111.056 15.3442C111.056 16.0882 111.149 16.8735 111.334 17.6847C111.356 17.774 111.411 18.0015 111.479 18.2154C111.544 18.4236 111.618 18.6199 111.642 18.6735L118.909 17.048C118.909 17.048 118.821 16.8016 118.773 16.5173C118.729 16.2433 118.703 15.9668 118.694 15.6894C118.694 13.596 120.246 12.3478 122.845 12.3478C125.677 12.3478 127.112 14.269 127.112 18.0602V21.1206L126.864 21.0916C124.921 20.8635 123.082 20.7477 121.401 20.7477C114.356 20.7477 110.476 23.3008 110.476 27.9375C110.476 32.3203 113.544 34.9359 118.684 34.9359C123.993 34.9359 126.309 31.9341 127.319 29.4141L127.747 29.4804C128.037 33.1649 130.187 34.8797 134.513 34.8797C136.419 34.8797 137.858 34.4033 139.03 33.3842V30.32C138.727 30.4026 138.359 30.4727 137.863 30.4727C136.16 30.4727 135.332 29.5296 135.332 27.5908V27.5914ZM127.112 24.4149C127.112 28.2348 124.961 30.7036 121.634 30.7036C119.647 30.7036 118.461 29.6697 118.461 27.9379C118.461 25.4914 119.892 23.7659 126.875 23.3068L127.112 23.291V24.4149Z" fill="#E8E8E8"/>
              </g>
              <defs>
                <clipPath id="clip0_119_220">
                  <rect width="189.307" height="80" fill="white"/>
                </clipPath>
              </defs>
            </svg>
        </div>
      </div>
    </div>
  );
};